#!/usr/bin/env node
var packageInfo = require('../package.json')
var jmerge = require('../lib/index.js')
var program = require('commander')

program
  .version(packageInfo.version)
  .option('-d, --dir <path>', 'merge all results in directory')
    .option('-o, --out <mergedfile>', 'file to output to', './merged-test-results.xml')
  .arguments('<xmlFile1.xml> [xmlFile2.xml..]')

program.parse(process.argv)

var mergedXml = ''

// Was a directory provided?
if (program.dir) {
  mergedXml = jmerge.mergeFiles(jmerge.listXmlFiles(program.dir))
} else {
  if (!program.args.length > 0) {
    console.log('ERROR: Missing files to merge...')
    program.help()
  } else {
    mergedXml = jmerge.mergeFiles(program.args)
  }
}

jmerge.writeMergedFile(program.out, mergedXml)
